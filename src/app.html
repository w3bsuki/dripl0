<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="%sveltekit.assets%/favicon.svg" />
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
		%sveltekit.head%
		
		<!-- Cookie Consent Default State -->
		<script>
			// Set default consent state for Google Analytics
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			
			// Default to denied until user gives consent
			gtag('consent', 'default', {
				'analytics_storage': 'denied',
				'ad_storage': 'denied',
				'ad_user_data': 'denied',
				'ad_personalization': 'denied',
				'functionality_storage': 'denied',
				'personalization_storage': 'denied',
				'security_storage': 'granted'
			});
			
			// Check for existing consent
			try {
				const consent = localStorage.getItem('driplo-cookie-consent');
				if (consent) {
					const parsed = JSON.parse(consent);
					if (parsed.version === '1.0' && parsed.consent?.consentGiven) {
						const prefs = parsed.consent.preferences;
						gtag('consent', 'update', {
							'analytics_storage': prefs.analytics ? 'granted' : 'denied',
							'ad_storage': prefs.marketing ? 'granted' : 'denied',
							'ad_user_data': prefs.marketing ? 'granted' : 'denied',
							'ad_personalization': prefs.marketing ? 'granted' : 'denied',
							'functionality_storage': prefs.preferences ? 'granted' : 'denied',
							'personalization_storage': prefs.preferences ? 'granted' : 'denied'
						});
					}
				}
			} catch (e) {
				// Ignore errors
			}
		</script>
		
		<!-- Google Analytics (if you have it) -->
		<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'GA_MEASUREMENT_ID');
		</script> -->
	</head>
	<body data-sveltekit-preload-data="hover" class="min-h-screen">
		<div style="display: contents">%sveltekit.body%</div>
	</body>
</html>
